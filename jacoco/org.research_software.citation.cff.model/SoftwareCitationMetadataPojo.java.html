<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>SoftwareCitationMetadataPojo.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Citation File Format Java Reader</a> &gt; <a href="index.source.html" class="el_package">org.research_software.citation.cff.model</a> &gt; <span class="el_source">SoftwareCitationMetadataPojo.java</span></div><h1>SoftwareCitationMetadataPojo.java</h1><pre class="source lang-java linenums">/**
 * Copyright (c) 2018ff. Stephan Druskat
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *       http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.research_software.citation.cff.model;

import java.net.MalformedURLException;
import java.net.URL;
import java.time.LocalDate;
import java.time.format.DateTimeParseException;
import java.util.ArrayList;
import java.util.List;

import org.research_software.citation.cff.exceptions.InvalidDataException;
import org.research_software.citation.cff.model.objects.Entity;
import org.research_software.citation.cff.model.objects.Person;
import org.research_software.citation.cff.model.objects.Reference;
import org.research_software.citation.cff.model.objects.Subject;

import com.fasterxml.jackson.annotation.JsonInclude;
import com.fasterxml.jackson.annotation.JsonProperty;

/**
 * A POJO-based implementation of {@link SoftwareCitationMetadata}.
 * 
 * @version Citation File Format Version 1.0.3
 *
 * @author Stephan Druskat &lt;[mail@sdruskat.net](mailto:mail@sdruskat.net)&gt;
 * 
 */
@JsonInclude(JsonInclude.Include.NON_NULL)
final class SoftwareCitationMetadataPojo implements SoftwareCitationMetadata {

<span class="fc" id="L45">	private static final Object CFF_VERSION = &quot;1.0.3&quot;;</span>
	private String cffVersion;
	private String message;
	private String abstractString; // &quot;abstract&quot; is a reserved term
<span class="fc" id="L49">	private List&lt;Subject&gt; authors = new ArrayList&lt;Subject&gt;();</span>
	private String commit;
<span class="fc" id="L51">	private List&lt;Subject&gt; contact = new ArrayList&lt;Subject&gt;();</span>
	private LocalDate dateReleased;
	private String doi;
<span class="fc" id="L54">	private List&lt;String&gt; keywords = new ArrayList&lt;String&gt;();</span>
	private String license;
	private URL licenseUrl;
	private URL repository;
	private URL repositoryCode;
	private URL repositoryArtifact;
	private String title;
	private URL url;
	private String version;
<span class="fc" id="L63">	private List&lt;Reference&gt; references = new ArrayList&lt;Reference&gt;();</span>

	/**
	 * Constructor for databinding.
	 * 
	 * @param repositoryArtifact
	 * @param dateReleased
	 * @param keywords
	 * @param contact
	 * @param url
	 * @param version
	 * @param message
	 * @param authors
	 * @param references
	 * @param title
	 * @param repositoryCode
	 * @param commit
	 * @param repository
	 * @param license
	 * @param doi
	 * @param licenseUrl
	 * @param cffVersion
	 * @param abstractString
	 * @throws InvalidDataException on invalid data and resulting parse errors, e.g., for date/time parses
	 */
	public SoftwareCitationMetadataPojo(@JsonProperty(&quot;cff-version&quot;) String cffVersion,
			@JsonProperty(&quot;message&quot;) String message,
			@JsonProperty(value = &quot;authors&quot;, required = true) List&lt;Subject&gt; authors,
			@JsonProperty(&quot;date-released&quot;) String dateReleased, 
			@JsonProperty(&quot;title&quot;) String title,
			@JsonProperty(&quot;version&quot;) String version, 
			@JsonProperty(&quot;abstract&quot;) String abstractString, 
			@JsonProperty(&quot;commit&quot;) String commit,
			@JsonProperty(&quot;contact&quot;) List&lt;Subject&gt; contact, 
			@JsonProperty(&quot;doi&quot;) String doi,
			@JsonProperty(&quot;keywords&quot;) List&lt;String&gt; keywords, 
			@JsonProperty(&quot;license&quot;) String license,
			@JsonProperty(&quot;license-url&quot;) String licenseUrl, 
			@JsonProperty(&quot;repository&quot;) String repository,
			@JsonProperty(&quot;repository-code&quot;) String repositoryCode,
			@JsonProperty(&quot;repository-artifact&quot;) String repositoryArtifact, 
			@JsonProperty(&quot;url&quot;) String url,
			@JsonProperty(&quot;references&quot;) List&lt;Reference&gt; references)
			throws InvalidDataException {
<span class="fc" id="L107">		super();</span>
<span class="pc bpc" id="L108" title="1 of 2 branches missed.">		if (cffVersion == null) {</span>
<span class="nc" id="L109">			throw new NullPointerException(&quot;'cff-version' is a required key and must be present and not null!&quot;);</span>
		}
<span class="fc bfc" id="L111" title="All 2 branches covered.">		else if (!cffVersion.equals(CFF_VERSION)) {</span>
<span class="fc" id="L112">			throw new InvalidDataException(&quot;'cff-version' must be &quot; + CFF_VERSION + &quot;!&quot;);</span>
		}
<span class="fc" id="L114">		this.cffVersion = cffVersion;</span>
<span class="pc bpc" id="L115" title="1 of 2 branches missed.">		if (message == null) {</span>
<span class="nc" id="L116">			throw new InvalidDataException(&quot;'message' is a required key and must be present and not null!&quot;);</span>
		}
<span class="fc" id="L118">		this.message = message;</span>
<span class="fc" id="L119">		this.abstractString = abstractString;</span>
<span class="pc bpc" id="L120" title="1 of 2 branches missed.">		if (authors == null) {</span>
<span class="nc" id="L121">			throw new InvalidDataException(&quot;'authors' is a required key and must be present and not null!&quot;);</span>
		}
<span class="fc" id="L123">		this.authors = authors;</span>
<span class="fc" id="L124">		this.commit = commit;</span>
<span class="fc" id="L125">		this.contact = contact;</span>
<span class="fc" id="L126">		convertAndSetDateReleased(dateReleased);</span>
<span class="fc" id="L127">		this.doi = doi;</span>
<span class="fc" id="L128">		this.keywords = keywords;</span>
<span class="fc" id="L129">		this.license = license;</span>
<span class="fc" id="L130">		convertAndSetLicenseUrl(licenseUrl);</span>
<span class="fc" id="L131">		convertAndSetRepository(repository);</span>
<span class="fc" id="L132">		convertAndSetRepositoryCode(repositoryCode);</span>
<span class="fc" id="L133">		convertAndSetRepositoryArtifact(repositoryArtifact);</span>
<span class="pc bpc" id="L134" title="1 of 2 branches missed.">		if (title == null) {</span>
<span class="nc" id="L135">			throw new InvalidDataException(&quot;'title' is a required key and must be present and not null!&quot;);</span>
		}
<span class="fc" id="L137">		this.title = title;</span>
<span class="fc" id="L138">		convertAndSetUrl(url);</span>
<span class="pc bpc" id="L139" title="1 of 2 branches missed.">		if (version == null) {</span>
<span class="nc" id="L140">			throw new InvalidDataException(&quot;'version' is a required key and must be present and not null!&quot;);</span>
		}
<span class="fc" id="L142">		this.version = version;</span>
<span class="fc" id="L143">		this.references = references;</span>
<span class="fc" id="L144">	}</span>

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#getCffVersion()
	 */
	@JsonProperty(&quot;cff-version&quot;)
	public String getCffVersion() {
<span class="fc" id="L151">		return cffVersion;</span>
	}

	@JsonProperty(&quot;cff-version&quot;)
	private void setCffVersion(String cffVersion) {
<span class="nc" id="L156">		this.cffVersion = cffVersion;</span>
<span class="nc" id="L157">	}</span>

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#getMessage()
	 */
	@JsonProperty(&quot;message&quot;)
	public String getMessage() {
<span class="fc" id="L164">		return message;</span>
	}

	@JsonProperty(&quot;message&quot;)
	private void setMessage(String message) {
<span class="nc" id="L169">		this.message = message;</span>
<span class="nc" id="L170">	}</span>

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#getAbstract()
	 */
	@JsonProperty(&quot;abstract&quot;)
	public String getAbstract() {
<span class="fc" id="L177">		return abstractString;</span>
	}

	@JsonProperty(&quot;abstract&quot;)
	private void setAbstract(String _abstract) {
<span class="nc" id="L182">		this.abstractString = _abstract;</span>
<span class="nc" id="L183">	}</span>

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#getAuthors()
	 */
	@JsonProperty(&quot;authors&quot;)
	public List&lt;Subject&gt; getAuthors() {
<span class="fc" id="L190">		return authors;</span>
	}

	@JsonProperty(&quot;authors&quot;)
	private void setAuthors(List&lt;Subject&gt; authors) {
<span class="nc" id="L195">		this.authors = authors;</span>
<span class="nc" id="L196">	}</span>

	/*
	 * (non-Javadoc)
	 * 
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#
	 * getPersonAuthors()
	 */
	@Override
	public List&lt;Person&gt; getPersonAuthors() {
<span class="fc" id="L206">		return filterPersons(getAuthors());</span>
	}
	
	/*
	 * (non-Javadoc)
	 * 
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#
	 * getEntityAuthors()
	 */
	@Override
	public List&lt;Entity&gt; getEntityAuthors() {
<span class="fc" id="L217">		return filterEntities(getAuthors());</span>
	}

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#getCommit()
	 */
	@JsonProperty(&quot;commit&quot;)
	public String getCommit() {
<span class="fc" id="L225">		return commit;</span>
	}

	@JsonProperty(&quot;commit&quot;)
	private void setCommit(String commit) {
<span class="nc" id="L230">		this.commit = commit;</span>
<span class="nc" id="L231">	}</span>

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#getContacts()
	 */
	@JsonProperty(&quot;contact&quot;)
	public List&lt;Subject&gt; getContacts() {
<span class="fc" id="L238">		return contact;</span>
	}

	/*
	 * (non-Javadoc)
	 * 
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#
	 * getPersonContacts()
	 */
	@Override
	public List&lt;Person&gt; getPersonContacts() {
<span class="fc" id="L249">		return filterPersons(getContacts());</span>
	}

	/*
	 * (non-Javadoc)
	 * 
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#
	 * getEntityContacts()
	 */
	@Override
	public List&lt;Entity&gt; getEntityContacts() {
<span class="fc" id="L260">		return filterEntities(getContacts());</span>
	}

	@JsonProperty(&quot;contact&quot;)
	private void setContact(List&lt;Subject&gt; contact) {
<span class="nc" id="L265">		this.contact = contact;</span>
<span class="nc" id="L266">	}</span>

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#getDateReleased()
	 */
	@JsonProperty(&quot;date-released&quot;)
	public LocalDate getDateReleased() {
<span class="fc" id="L273">		return dateReleased;</span>
	}

	@JsonProperty(&quot;date-released&quot;)
	public void convertAndSetDateReleased(String dateReleased) throws InvalidDataException {
		try {
<span class="fc" id="L279">			this.dateReleased = LocalDate.parse(dateReleased);</span>
<span class="fc" id="L280">		}</span>
<span class="fc" id="L281">		catch (DateTimeParseException e) {</span>
<span class="fc" id="L282">			throw new InvalidDataException(&quot;DateTimeParseException in field 'date-released'!&quot;, e);</span>
		}
<span class="nc" id="L284">		catch (NullPointerException e) {</span>
<span class="nc" id="L285">			throw new InvalidDataException(&quot;'date-released' is a required value and must not be empty or null!&quot;);</span>
		}
<span class="fc" id="L287">	}</span>

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#getDoi()
	 */
	@JsonProperty(&quot;doi&quot;)
	public String getDoi() {
<span class="fc" id="L294">		return doi;</span>
	}

	@JsonProperty(&quot;doi&quot;)
	public void setDoi(String doi) {
<span class="nc" id="L299">		this.doi = doi;</span>
<span class="nc" id="L300">	}</span>

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#getKeywords()
	 */
	@JsonProperty(&quot;keywords&quot;)
	public List&lt;String&gt; getKeywords() {
<span class="fc" id="L307">		return keywords;</span>
	}

	@JsonProperty(&quot;keywords&quot;)
	public void setKeywords(List&lt;String&gt; keywords) {
<span class="nc" id="L312">		this.keywords = keywords;</span>
<span class="nc" id="L313">	}</span>

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#getLicense()
	 */
	@JsonProperty(&quot;license&quot;)
	public String getLicense() {
<span class="fc" id="L320">		return license;</span>
	}

	@JsonProperty(&quot;license&quot;)
	public void setLicense(String license) {
<span class="nc" id="L325">		this.license = license;</span>
<span class="nc" id="L326">	}</span>

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#getLicenseUrl()
	 */
	@JsonProperty(&quot;license-url&quot;)
	public URL getLicenseUrl() {
<span class="fc" id="L333">		return licenseUrl;</span>
	}

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#convertAndSetLicenseUrl(java.lang.String)
	 */
	@JsonProperty(&quot;license-url&quot;)
	public void convertAndSetLicenseUrl(String licenseUrl) throws InvalidDataException {
<span class="fc bfc" id="L341" title="All 2 branches covered.">		if (licenseUrl != null) {</span>
			try {
<span class="fc" id="L343">				this.licenseUrl = new URL(licenseUrl);</span>
<span class="fc" id="L344">			}</span>
<span class="nc" id="L345">			catch (MalformedURLException e) {</span>
<span class="nc" id="L346">				throw new InvalidDataException(&quot;The citation metadata for '&quot; + getTitle()</span>
<span class="nc" id="L347">						+ &quot;' contains an invalid URL in field 'license-url'!&quot;, e);</span>
			}
		}
<span class="fc" id="L350">	}</span>

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#getRepository()
	 */
	@JsonProperty(&quot;repository&quot;)
	public URL getRepository() {
<span class="fc" id="L357">		return repository;</span>
	}

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#convertAndSetRepository(java.lang.String)
	 */
	@JsonProperty(&quot;repository&quot;)
	public void convertAndSetRepository(String repository) throws InvalidDataException {
<span class="fc bfc" id="L365" title="All 2 branches covered.">		if (repository != null) {</span>
			try {
<span class="fc" id="L367">				this.repository = new URL(repository);</span>
<span class="fc" id="L368">			}</span>
<span class="nc" id="L369">			catch (MalformedURLException e) {</span>
<span class="nc" id="L370">				throw new InvalidDataException(&quot;The citation metadata for '&quot; + getTitle()</span>
<span class="nc" id="L371">						+ &quot;' contains an invalid URL in field 'repository'!&quot;, e);</span>
			}
		}
<span class="fc" id="L374">	}</span>

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#getRepositoryCode()
	 */
	@JsonProperty(&quot;repository-code&quot;)
	public URL getRepositoryCode() {
<span class="fc" id="L381">		return repositoryCode;</span>
	}

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#convertAndSetRepositoryCode(java.lang.String)
	 */
	@JsonProperty(&quot;repository-code&quot;)
	public void convertAndSetRepositoryCode(String repositoryCode) throws InvalidDataException {
<span class="fc bfc" id="L389" title="All 2 branches covered.">		if (repositoryCode != null) {</span>
			try {
<span class="fc" id="L391">				this.repositoryCode = new URL(repositoryCode);</span>
<span class="fc" id="L392">			}</span>
<span class="nc" id="L393">			catch (MalformedURLException e) {</span>
<span class="nc" id="L394">				throw new InvalidDataException(&quot;The citation metadata for '&quot; + getTitle()</span>
<span class="nc" id="L395">						+ &quot;' contains an invalid URL in field 'repository-code'!&quot;, e);</span>
			}
		}
<span class="fc" id="L398">	}</span>

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#getRepositoryArtifact()
	 */
	@JsonProperty(&quot;repository-artifact&quot;)
	public URL getRepositoryArtifact() {
<span class="fc" id="L405">		return repositoryArtifact;</span>
	}

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#convertAndSetRepositoryArtifact(java.lang.String)
	 */
	@JsonProperty(&quot;repository-artifact&quot;)
	public void convertAndSetRepositoryArtifact(String repositoryArtifact) throws InvalidDataException {
<span class="fc bfc" id="L413" title="All 2 branches covered.">		if (repositoryArtifact != null) {</span>
			try {
<span class="fc" id="L415">				this.repositoryArtifact = new URL(repositoryArtifact);</span>
<span class="fc" id="L416">			}</span>
<span class="nc" id="L417">			catch (MalformedURLException e) {</span>
<span class="nc" id="L418">				throw new InvalidDataException(&quot;The citation metadata for '&quot; + getTitle()</span>
<span class="nc" id="L419">						+ &quot;' contains an invalid URL in field 'repository-artifact'!&quot;, e);</span>

			}
		}
<span class="fc" id="L423">	}</span>

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#getTitle()
	 */
	@JsonProperty(&quot;title&quot;)
	public String getTitle() {
<span class="fc" id="L430">		return title;</span>
	}

	@JsonProperty(&quot;title&quot;)
	private void setTitle(String title) {
<span class="nc" id="L435">		this.title = title;</span>
<span class="nc" id="L436">	}</span>

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#getUrl()
	 */
	@JsonProperty(&quot;url&quot;)
	public URL getUrl() {
<span class="fc" id="L443">		return url;</span>
	}

	/**
	 * // TODO Add description
	 * 
	 * @param url
	 * @throws InvalidDataException
	 */
	@JsonProperty(&quot;url&quot;)
	public void convertAndSetUrl(String url) throws InvalidDataException {
<span class="fc bfc" id="L454" title="All 2 branches covered.">		if (url != null) {</span>
			try {
<span class="fc" id="L456">				this.url = new URL(url);</span>
<span class="fc" id="L457">			}</span>
<span class="fc" id="L458">			catch (MalformedURLException e) {</span>
<span class="fc" id="L459">				throw new InvalidDataException(&quot;The citation metadata for '&quot; + getTitle()</span>
<span class="fc" id="L460">						+ &quot;' contains an invalid URL in field 'url'!&quot;, e);</span>
			}
		}
<span class="fc" id="L463">	}</span>

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#getVersion()
	 */
	@JsonProperty(&quot;version&quot;)
	public String getVersion() {
<span class="fc" id="L470">		return version;</span>
	}

	@JsonProperty(&quot;version&quot;)
	private void setVersion(String version) {
<span class="nc" id="L475">		this.version = version;</span>
<span class="nc" id="L476">	}</span>

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#getReferences()
	 */
	@JsonProperty(&quot;references&quot;)
	public List&lt;Reference&gt; getReferences() {
<span class="fc" id="L483">		return references;</span>
	}

	@JsonProperty(&quot;references&quot;)
	private void setReferences(List&lt;Reference&gt; references) {
<span class="nc" id="L488">		this.references = references;</span>
<span class="nc" id="L489">	}</span>

	/*
	 * HELPER METHODS
	 */

	private List&lt;Person&gt; filterPersons(List&lt;Subject&gt; subjects) {
<span class="fc" id="L496">		List&lt;Person&gt; personList = new ArrayList&lt;&gt;();</span>
<span class="fc bfc" id="L497" title="All 2 branches covered.">		for (Subject subject : subjects) {</span>
<span class="fc bfc" id="L498" title="All 2 branches covered.">			if (subject instanceof Person) {</span>
<span class="fc" id="L499">				personList.add((Person) subject);</span>
			}
		}
<span class="fc" id="L502">		return personList;</span>
	}

	private List&lt;Entity&gt; filterEntities(List&lt;Subject&gt; subjects) {
<span class="fc" id="L506">		List&lt;Entity&gt; entityList = new ArrayList&lt;&gt;();</span>
<span class="fc bfc" id="L507" title="All 2 branches covered.">		for (Subject subject : subjects) {</span>
<span class="fc bfc" id="L508" title="All 2 branches covered.">			if (subject instanceof Entity) {</span>
<span class="fc" id="L509">				entityList.add((Entity) subject);</span>
			}
		}
<span class="fc" id="L512">		return entityList;</span>
	}

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.6.201602180812</span></div></body></html>