<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>SoftwareCitationMetadataPojo.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Citation File Format Java Reader</a> &gt; <a href="index.source.html" class="el_package">org.research_software.citation.cff.model</a> &gt; <span class="el_source">SoftwareCitationMetadataPojo.java</span></div><h1>SoftwareCitationMetadataPojo.java</h1><pre class="source lang-java linenums">/**
 * 
 */
package org.research_software.citation.cff.model;

import java.net.MalformedURLException;
import java.net.URL;
import java.time.LocalDate;
import java.time.format.DateTimeParseException;
import java.util.ArrayList;
import java.util.List;

import org.research_software.citation.cff.exceptions.InvalidDataException;
import org.research_software.citation.cff.model.objects.Entity;
import org.research_software.citation.cff.model.objects.Person;
import org.research_software.citation.cff.model.objects.Reference;
import org.research_software.citation.cff.model.objects.Subject;

import com.fasterxml.jackson.annotation.JsonInclude;
import com.fasterxml.jackson.annotation.JsonProperty;

/**
 * A POJO-based implementation of {@link SoftwareCitationMetadata}.
 * 
 * @version Citation File Format Version 1.0.3
 *
 * @author Stephan Druskat &lt;[mail@sdruskat.net](mailto:mail@sdruskat.net)&gt;
 * 
 */
@JsonInclude(JsonInclude.Include.NON_NULL)
final class SoftwareCitationMetadataPojo implements SoftwareCitationMetadata {

<span class="nc" id="L33">	private static final Object CFF_VERSION = &quot;1.0.3&quot;;</span>
	private String cffVersion;
	private String message;
	private String abstractString; // &quot;abstract&quot; is a reserved term
<span class="nc" id="L37">	private List&lt;Subject&gt; authors = new ArrayList&lt;Subject&gt;();</span>
	private String commit;
<span class="nc" id="L39">	private List&lt;Subject&gt; contact = new ArrayList&lt;Subject&gt;();</span>
	private LocalDate dateReleased;
	private String doi;
<span class="nc" id="L42">	private List&lt;String&gt; keywords = new ArrayList&lt;String&gt;();</span>
	private String license;
	private URL licenseUrl;
	private URL repository;
	private URL repositoryCode;
	private URL repositoryArtifact;
	private String title;
	private URL url;
	private String version;
<span class="nc" id="L51">	private List&lt;Reference&gt; references = new ArrayList&lt;Reference&gt;();</span>

	/**
	 * Constructor for databinding.
	 * 
	 * @param repositoryArtifact
	 * @param dateReleased
	 * @param keywords
	 * @param contact
	 * @param url
	 * @param version
	 * @param message
	 * @param authors
	 * @param references
	 * @param title
	 * @param repositoryCode
	 * @param commit
	 * @param repository
	 * @param license
	 * @param doi
	 * @param licenseUrl
	 * @param cffVersion
	 * @param abstractString
	 * @throws InvalidDataException on invalid data and resulting parse errors, e.g., for date/time parses
	 */
	public SoftwareCitationMetadataPojo(@JsonProperty(&quot;cff-version&quot;) String cffVersion,
			@JsonProperty(&quot;message&quot;) String message,
			@JsonProperty(value = &quot;authors&quot;, required = true) List&lt;Subject&gt; authors,
			@JsonProperty(&quot;date-released&quot;) String dateReleased, 
			@JsonProperty(&quot;title&quot;) String title,
			@JsonProperty(&quot;version&quot;) String version, 
			@JsonProperty(&quot;abstract&quot;) String abstractString, 
			@JsonProperty(&quot;commit&quot;) String commit,
			@JsonProperty(&quot;contact&quot;) List&lt;Subject&gt; contact, 
			@JsonProperty(&quot;doi&quot;) String doi,
			@JsonProperty(&quot;keywords&quot;) List&lt;String&gt; keywords, 
			@JsonProperty(&quot;license&quot;) String license,
			@JsonProperty(&quot;license-url&quot;) String licenseUrl, 
			@JsonProperty(&quot;repository&quot;) String repository,
			@JsonProperty(&quot;repository-code&quot;) String repositoryCode,
			@JsonProperty(&quot;repository-artifact&quot;) String repositoryArtifact, 
			@JsonProperty(&quot;url&quot;) String url,
			@JsonProperty(&quot;references&quot;) List&lt;Reference&gt; references)
			throws InvalidDataException {
<span class="nc" id="L95">		super();</span>
<span class="nc bnc" id="L96" title="All 2 branches missed.">		if (cffVersion == null) {</span>
<span class="nc" id="L97">			throw new NullPointerException(&quot;'cff-version' is a required key and must be present and not null!&quot;);</span>
		}
<span class="nc bnc" id="L99" title="All 2 branches missed.">		else if (!cffVersion.equals(CFF_VERSION)) {</span>
<span class="nc" id="L100">			throw new InvalidDataException(&quot;'cff-version' must be &quot; + CFF_VERSION + &quot;!&quot;);</span>
		}
<span class="nc" id="L102">		this.cffVersion = cffVersion;</span>
<span class="nc bnc" id="L103" title="All 2 branches missed.">		if (message == null) {</span>
<span class="nc" id="L104">			throw new InvalidDataException(&quot;'message' is a required key and must be present and not null!&quot;);</span>
		}
<span class="nc" id="L106">		this.message = message;</span>
<span class="nc" id="L107">		this.abstractString = abstractString;</span>
<span class="nc bnc" id="L108" title="All 2 branches missed.">		if (authors == null) {</span>
<span class="nc" id="L109">			throw new InvalidDataException(&quot;'authors' is a required key and must be present and not null!&quot;);</span>
		}
<span class="nc" id="L111">		this.authors = authors;</span>
<span class="nc" id="L112">		this.commit = commit;</span>
<span class="nc" id="L113">		this.contact = contact;</span>
<span class="nc bnc" id="L114" title="All 2 branches missed.">		if (dateReleased == null) {</span>
<span class="nc" id="L115">			throw new InvalidDataException(&quot;'date-released' is a required key and must be present and not null!&quot;);</span>
		}
<span class="nc" id="L117">		setDateReleased(dateReleased);</span>
<span class="nc" id="L118">		this.doi = doi;</span>
<span class="nc" id="L119">		this.keywords = keywords;</span>
<span class="nc" id="L120">		this.license = license;</span>
<span class="nc" id="L121">		setLicenseUrl(licenseUrl);</span>
<span class="nc" id="L122">		setRepository(repository);</span>
<span class="nc" id="L123">		setRepositoryCode(repositoryCode);</span>
<span class="nc" id="L124">		setRepositoryArtifact(repositoryArtifact);</span>
<span class="nc bnc" id="L125" title="All 2 branches missed.">		if (title == null) {</span>
<span class="nc" id="L126">			throw new InvalidDataException(&quot;'title' is a required key and must be present and not null!&quot;);</span>
		}
<span class="nc" id="L128">		this.title = title;</span>
<span class="nc" id="L129">		setUrl(url);</span>
<span class="nc bnc" id="L130" title="All 2 branches missed.">		if (version == null) {</span>
<span class="nc" id="L131">			throw new InvalidDataException(&quot;'version' is a required key and must be present and not null!&quot;);</span>
		}
<span class="nc" id="L133">		this.version = version;</span>
<span class="nc" id="L134">		this.references = references;</span>
<span class="nc" id="L135">	}</span>

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#getCffVersion()
	 */
	@JsonProperty(&quot;cff-version&quot;)
	public String getCffVersion() {
<span class="nc" id="L142">		return cffVersion;</span>
	}

	@JsonProperty(&quot;cff-version&quot;)
	private void setCffVersion(String cffVersion) {
<span class="nc" id="L147">		this.cffVersion = cffVersion;</span>
<span class="nc" id="L148">	}</span>

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#getMessage()
	 */
	@JsonProperty(&quot;message&quot;)
	public String getMessage() {
<span class="nc" id="L155">		return message;</span>
	}

	@JsonProperty(&quot;message&quot;)
	private void setMessage(String message) {
<span class="nc" id="L160">		this.message = message;</span>
<span class="nc" id="L161">	}</span>

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#getAbstract()
	 */
	@JsonProperty(&quot;abstract&quot;)
	public String getAbstract() {
<span class="nc" id="L168">		return abstractString;</span>
	}

	@JsonProperty(&quot;abstract&quot;)
	private void setAbstract(String _abstract) {
<span class="nc" id="L173">		this.abstractString = _abstract;</span>
<span class="nc" id="L174">	}</span>

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#getAuthors()
	 */
	@JsonProperty(&quot;authors&quot;)
	public List&lt;Subject&gt; getAuthors() {
<span class="nc" id="L181">		return authors;</span>
	}

	@JsonProperty(&quot;authors&quot;)
	private void setAuthors(List&lt;Subject&gt; authors) {
<span class="nc" id="L186">		this.authors = authors;</span>
<span class="nc" id="L187">	}</span>

	/*
	 * (non-Javadoc)
	 * 
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#
	 * getPersonAuthors()
	 */
	@Override
	public List&lt;Person&gt; getPersonAuthors() {
<span class="nc" id="L197">		return filterPersons(getAuthors());</span>
	}
	
	/*
	 * (non-Javadoc)
	 * 
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#
	 * getEntityAuthors()
	 */
	@Override
	public List&lt;Entity&gt; getEntityAuthors() {
<span class="nc" id="L208">		return filterEntities(getAuthors());</span>
	}

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#getCommit()
	 */
	@JsonProperty(&quot;commit&quot;)
	public String getCommit() {
<span class="nc" id="L216">		return commit;</span>
	}

	@JsonProperty(&quot;commit&quot;)
	private void setCommit(String commit) {
<span class="nc" id="L221">		this.commit = commit;</span>
<span class="nc" id="L222">	}</span>

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#getContacts()
	 */
	@JsonProperty(&quot;contact&quot;)
	public List&lt;Subject&gt; getContacts() {
<span class="nc" id="L229">		return contact;</span>
	}

	/*
	 * (non-Javadoc)
	 * 
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#
	 * getPersonContacts()
	 */
	@Override
	public List&lt;Person&gt; getPersonContacts() {
<span class="nc" id="L240">		return filterPersons(getContacts());</span>
	}

	/*
	 * (non-Javadoc)
	 * 
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#
	 * getEntityContacts()
	 */
	@Override
	public List&lt;Entity&gt; getEntityContacts() {
<span class="nc" id="L251">		return filterEntities(getContacts());</span>
	}

	@JsonProperty(&quot;contact&quot;)
	private void setContact(List&lt;Subject&gt; contact) {
<span class="nc" id="L256">		this.contact = contact;</span>
<span class="nc" id="L257">	}</span>

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#getDateReleased()
	 */
	@JsonProperty(&quot;date-released&quot;)
	public LocalDate getDateReleased() {
<span class="nc" id="L264">		return dateReleased;</span>
	}

	@JsonProperty(&quot;date-released&quot;)
	private void setDateReleased(String dateReleased) throws InvalidDataException {
		try {
<span class="nc" id="L270">			this.dateReleased = LocalDate.parse(dateReleased);</span>
<span class="nc" id="L271">		}</span>
<span class="nc" id="L272">		catch (DateTimeParseException e) {</span>
<span class="nc" id="L273">			throw new InvalidDataException(&quot;DateTimeParseException in field 'date-released'!&quot;, e);</span>
		}
<span class="nc" id="L275">		catch (NullPointerException e) {</span>
<span class="nc" id="L276">			throw new InvalidDataException(&quot;'date-released' is a required value and must not be empty or null!&quot;);</span>
		}
<span class="nc" id="L278">	}</span>

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#getDoi()
	 */
	@JsonProperty(&quot;doi&quot;)
	public String getDoi() {
<span class="nc" id="L285">		return doi;</span>
	}

	@JsonProperty(&quot;doi&quot;)
	public void setDoi(String doi) {
<span class="nc" id="L290">		this.doi = doi;</span>
<span class="nc" id="L291">	}</span>

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#getKeywords()
	 */
	@JsonProperty(&quot;keywords&quot;)
	public List&lt;String&gt; getKeywords() {
<span class="nc" id="L298">		return keywords;</span>
	}

	@JsonProperty(&quot;keywords&quot;)
	public void setKeywords(List&lt;String&gt; keywords) {
<span class="nc" id="L303">		this.keywords = keywords;</span>
<span class="nc" id="L304">	}</span>

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#getLicense()
	 */
	@JsonProperty(&quot;license&quot;)
	public String getLicense() {
<span class="nc" id="L311">		return license;</span>
	}

	@JsonProperty(&quot;license&quot;)
	public void setLicense(String license) {
<span class="nc" id="L316">		this.license = license;</span>
<span class="nc" id="L317">	}</span>

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#getLicenseUrl()
	 */
	@JsonProperty(&quot;license-url&quot;)
	public URL getLicenseUrl() {
<span class="nc" id="L324">		return licenseUrl;</span>
	}

	@JsonProperty(&quot;license-url&quot;)
	private void setLicenseUrl(String licenseUrl) throws InvalidDataException {
<span class="nc bnc" id="L329" title="All 2 branches missed.">		if (licenseUrl != null) {</span>
			try {
<span class="nc" id="L331">				this.licenseUrl = new URL(licenseUrl);</span>
<span class="nc" id="L332">			}</span>
<span class="nc" id="L333">			catch (MalformedURLException e) {</span>
<span class="nc" id="L334">				throw new InvalidDataException(&quot;The citation metadata for '&quot; + getTitle()</span>
<span class="nc" id="L335">						+ &quot;' contains an invalid URL in field 'license-url'!&quot;, e);</span>
			}
		}
<span class="nc" id="L338">	}</span>

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#getRepository()
	 */
	@JsonProperty(&quot;repository&quot;)
	public URL getRepository() {
<span class="nc" id="L345">		return repository;</span>
	}

	@JsonProperty(&quot;repository&quot;)
	private void setRepository(String repository) throws InvalidDataException {
<span class="nc bnc" id="L350" title="All 2 branches missed.">		if (repository != null) {</span>
			try {
<span class="nc" id="L352">				this.repository = new URL(repository);</span>
<span class="nc" id="L353">			}</span>
<span class="nc" id="L354">			catch (MalformedURLException e) {</span>
<span class="nc" id="L355">				throw new InvalidDataException(&quot;The citation metadata for '&quot; + getTitle()</span>
<span class="nc" id="L356">						+ &quot;' contains an invalid URL in field 'repository'!&quot;, e);</span>
			}
		}
<span class="nc" id="L359">	}</span>

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#getRepositoryCode()
	 */
	@JsonProperty(&quot;repository-code&quot;)
	public URL getRepositoryCode() {
<span class="nc" id="L366">		return repositoryCode;</span>
	}

	@JsonProperty(&quot;repository-code&quot;)
	private void setRepositoryCode(String repositoryCode) throws InvalidDataException {
<span class="nc bnc" id="L371" title="All 2 branches missed.">		if (repositoryCode != null) {</span>
			try {
<span class="nc" id="L373">				this.repositoryCode = new URL(repositoryCode);</span>
<span class="nc" id="L374">			}</span>
<span class="nc" id="L375">			catch (MalformedURLException e) {</span>
<span class="nc" id="L376">				throw new InvalidDataException(&quot;The citation metadata for '&quot; + getTitle()</span>
<span class="nc" id="L377">						+ &quot;' contains an invalid URL in field 'repository-code'!&quot;, e);</span>
			}
		}
<span class="nc" id="L380">	}</span>

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#getRepositoryArtifact()
	 */
	@JsonProperty(&quot;repository-artifact&quot;)
	public URL getRepositoryArtifact() {
<span class="nc" id="L387">		return repositoryArtifact;</span>
	}

	@JsonProperty(&quot;repository-artifact&quot;)
	private void setRepositoryArtifact(String repositoryArtifact) throws InvalidDataException {
<span class="nc bnc" id="L392" title="All 2 branches missed.">		if (repositoryArtifact != null) {</span>
			try {
<span class="nc" id="L394">				this.repositoryArtifact = new URL(repositoryArtifact);</span>
<span class="nc" id="L395">			}</span>
<span class="nc" id="L396">			catch (MalformedURLException e) {</span>
<span class="nc" id="L397">				throw new InvalidDataException(&quot;The citation metadata for '&quot; + getTitle()</span>
<span class="nc" id="L398">						+ &quot;' contains an invalid URL in field 'repository-artifact'!&quot;, e);</span>

			}
		}
<span class="nc" id="L402">	}</span>

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#getTitle()
	 */
	@JsonProperty(&quot;title&quot;)
	public String getTitle() {
<span class="nc" id="L409">		return title;</span>
	}

	@JsonProperty(&quot;title&quot;)
	private void setTitle(String title) {
<span class="nc" id="L414">		this.title = title;</span>
<span class="nc" id="L415">	}</span>

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#getUrl()
	 */
	@JsonProperty(&quot;url&quot;)
	public URL getUrl() {
<span class="nc" id="L422">		return url;</span>
	}

	@JsonProperty(&quot;url&quot;)
	private void setUrl(String url) throws InvalidDataException {
<span class="nc bnc" id="L427" title="All 2 branches missed.">		if (url != null) {</span>
			try {
<span class="nc" id="L429">				this.url = new URL(url);</span>
<span class="nc" id="L430">			}</span>
<span class="nc" id="L431">			catch (MalformedURLException e) {</span>
<span class="nc" id="L432">				throw new InvalidDataException(&quot;The citation metadata for '&quot; + getTitle()</span>
<span class="nc" id="L433">						+ &quot;' contains an invalid URL in field 'url'!&quot;, e);</span>
			}
		}
<span class="nc" id="L436">	}</span>

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#getVersion()
	 */
	@JsonProperty(&quot;version&quot;)
	public String getVersion() {
<span class="nc" id="L443">		return version;</span>
	}

	@JsonProperty(&quot;version&quot;)
	private void setVersion(String version) {
<span class="nc" id="L448">		this.version = version;</span>
<span class="nc" id="L449">	}</span>

	/* (non-Javadoc)
	 * @see org.research_software.citation.cff.model.SoftwareCitationMetadata#getReferences()
	 */
	@JsonProperty(&quot;references&quot;)
	public List&lt;Reference&gt; getReferences() {
<span class="nc" id="L456">		return references;</span>
	}

	@JsonProperty(&quot;references&quot;)
	private void setReferences(List&lt;Reference&gt; references) {
<span class="nc" id="L461">		this.references = references;</span>
<span class="nc" id="L462">	}</span>

	/*
	 * HELPER METHODS
	 */

	private List&lt;Person&gt; filterPersons(List&lt;Subject&gt; subjects) {
<span class="nc" id="L469">		List&lt;Person&gt; personList = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L470" title="All 2 branches missed.">		for (Subject subject : subjects) {</span>
<span class="nc bnc" id="L471" title="All 2 branches missed.">			if (subject instanceof Person) {</span>
<span class="nc" id="L472">				personList.add((Person) subject);</span>
			}
		}
<span class="nc" id="L475">		return personList;</span>
	}

	private List&lt;Entity&gt; filterEntities(List&lt;Subject&gt; subjects) {
<span class="nc" id="L479">		List&lt;Entity&gt; entityList = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L480" title="All 2 branches missed.">		for (Subject subject : subjects) {</span>
<span class="nc bnc" id="L481" title="All 2 branches missed.">			if (subject instanceof Entity) {</span>
<span class="nc" id="L482">				entityList.add((Entity) subject);</span>
			}
		}
<span class="nc" id="L485">		return entityList;</span>
	}

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.6.201602180812</span></div></body></html>